{extend name="layout"} {block name="css"}
<link rel="stylesheet" href="http://at.alicdn.com/t/font_626828_4pda2bnao1s.css" type="text/css" />
<link rel="stylesheet" type="text/css" href="__STATIC__/admin/common/css/bootstrap.min.css" />
<style type="text/css">
    body {
        background: #fff;
        position: relative;
    }

    .layui-form label {
        width: 17%;
        text-align: left;
    }

    .layui-form .layui-input-block input {
        width: 80%;
    }

    /* 数据库展现图片样式 */

    .img {
        position: relative;
        display: inline-block;
        width: 100px;
    }

    .img>i {
        display: inline-block;
        width: 20px;
        position: absolute;
        right: 0;
        top: 0;
    }

    /* 弹窗 */
    .tan {
        position: absolute;
        top: 10%;
        left: 30%;
        z-index: 1000;
    }

    #selectIcon .modal-dialog {
        width: 760px !important;
    }

    #selectIcon .modal-body {
        padding: 10px;
    }

    #selectIcon .main {
        height: 420px;
        overflow-y: auto;
        overflow-x: hidden;
    }

    #selectIcon .main nav {
        height: 60px;
        width: 80px;
        margin: 5px;
        display: block;
        float: left;
        cursor: pointer;
    }

    #selectIcon .main nav .iconimg {
        font-size: 30px;
        height: 38px;
        width: 80px;
        display: block;
        text-align: center;
        line-height: 38px;
    }

    #selectIcon .main nav .iconimg img {
        height: 100%;
    }

    #selectIcon .main nav .text {
        font-size: 10px;
        height: 22px;
        width: 80px;
        display: block;
        text-align: center;
        line-height: 22px;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    #selectIcon .main nav:hover {
        background: #f6f6f6;
    }

    .we7-modal-dialog .modal-header,
    .modal-dialog .modal-header {
        background-color: #f4f5f9;
        border-bottom: 0;
        border-top-right-radius: 10px;
        border-top-left-radius: 10px;
    }
    .noshow {display: none;}
    .show {display: block;}
</style>


{/block}

<body>

    {block name="content"}
    <div class="open">

    </div>
    <div class="modal fade noshow" id="selectIcon" >
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button data-dismiss="modal" class="close" type="button">×</button>
                    <h4 class="modal-title">选择图标</h4>
                </div>

                <ul class="nav nav-tabs" id="selectUrlTab">
                    <li class="active tab11" id="tab1"><a href="javascript:;" onclick="tab(1)">系统图标</a></li>
                    <li class="tab21" id="tab2"><a href="javascript:;" onclick="tab(2)">本地图片</a></li>
                </ul>
                <div class="modal-body set_c" id="set_c">
                    1
                </div>
                <div class="modal-body set_x" id="set_x" style="display: none">2</div>
            </div>
        </div>
    </div>
    <div class="modal-backdrop fade noshow" id="selectIcon" ></div>
    {if !empty($info)}
    <form class="layui-form" action="{:url('admin/User/grade_edit',['id'=>$info.member_grade_id])}" method="post"
        enctype="multipart/form-data">
        <div class="layui-form-item ">
            <label class="layui-form-label"><span>*</span>会员等级:</label>
            <div class="layui-input-block">
                <input type="text" value="{$info.member_grade_name}" name="member_grade_name" lay-verify="title"
                    autocomplete="off" placeholder="请输入" class="layui-input" id="goods_name">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label"><span>*</span>等级图标</label>
            <div class="layui-input-block">
                <div id="tup" >选择图片</div>
                <div class="imgcontent">
                    <span class="img">
                        <img src="__UPLOADS__/{$info.member_grade_img}" width="100%">
                        <i class="remove-img" data-id="{$info.member_grade_id}" data-value="2"><img
                                src="__STATIC__/admin/common/img/a7.png"></i>
                    </span>
                </div>
            </div>
            <!-- <div class="layui-input-block">
                <div class="img-box full">
                    <section class=" img-section">
                        <div class="z_photo upimg-div clear">
                            <section class="z_file fl">
                                <img src="__UPLOADS__/{$info.member_grade_img}" class="add-img">
                                <img src="__STATIC__/admin/common/upfile/img/a11.png" class="add-img">
                                <input type="file" name="member_grade_img" id="file" class="file" value=""
                                    accept="image/jpg,image/jpeg,image/png,image/bmp" multiple data-id="1" />
                            </section>
                        </div>
                    </section>
                </div>
                <aside class="mask works-mask">
                    <div class="mask-content">
                        <p class="del-p ">您确定要删除作品图片吗？</p>
                        <p class="check-p"><span class="del-com wsdel-ok">确定</span><span class="wsdel-no">取消</span></p>
                    </div>
                </aside>
            </div> -->
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">会员卡背景色：</label>
            <div class="layui-input-inline">
                <input type="color" name="member_background_color" id="" value="{$info.member_background_color}" />
            </div>

        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">有效期:</label>
            <div class="layui-input-inline">
                <select name="member_finite_period">
                    {if !empty($term_data)}
                    <!--<option value="{$info.member_finite_period}" selected="">{$info.member_finite_period}</option>-->
                    {volist name="term_data" id="vo"}
                    {if condition="$info.member_finite_period eq $vo.term_value"}
                    <option value="{$vo.term_value}" selected="">{$vo.term_name}</option>
                    {else}
                    <option value="{$vo.term_value}">{$vo.term_name}</option>
                    {/if}
                    {/volist}
                    {/if}
                </select> </div>

        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">首年消费满:</label>
            <div class="layui-input-block">
                <input value="{$info.first_year_pay_full}" type="text" name="first_year_pay_full" lay-verify="title"
                    autocomplete="off" placeholder="请输入" class="layui-input" id="sort_number">万元

            </div>
        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">次年消费满:</label>
            <div class="layui-input-block">
                <input value="{$info.second_year_pay_full}" type="text" name="second_year_pay_full" lay-verify="title"
                    autocomplete="off" placeholder="请输入" class="layui-input" id="sort_number">万元
            </div>
        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">充值送会员:</label>
            <div class="layui-input-block">
                <input value="{$info.recharge_member_send}" type="text" name="recharge_member_send" lay-verify="title"
                    autocomplete="off" placeholder="请输入" class="layui-input" id="sort_number">万元
            </div>
        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">充值送积分:</label>
            <div class="layui-input-block">
                <input value="{$info.recharge_integral_send}" type="text" name="recharge_integral_send"
                    lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input" id="sort_number">
            </div>
        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">会员消费折扣:</label>
            <div class="layui-input-block">
                <input value="{$info.member_consumption_discount}" type="text" name="member_consumption_discount"
                    lay-verify="title" autocomplete="off" placeholder="请输入" class="layui-input" id="sort_number">
            </div>
        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">是否介绍隐藏:</label>
            <div class="layui-input-block">
                {if $info.introduction_display == 1}
                <input type="radio" name="introduction_display" value="-1" title="隐藏">
                <input type="radio" name="introduction_display" value="1" title="不隐藏" checked="">
                {/if}
                {if $info.introduction_display == -1}
                <input type="radio" name="introduction_display" value="-1" title="隐藏" checked="">
                <input type="radio" name="introduction_display" value="1" title="不隐藏">
                {/if}
                {if ($info.introduction_display != 1&&$info.introduction_display != -1)}
                <input type="radio" name="introduction_display" value="-1" title="隐藏" checked="">
                <input type="radio" name="introduction_display" value="1" title="不隐藏">
                {/if}
            </div>

        </div>
        <div class="layui-form-item">
            <div class="layui-input-block">
                <button class="layui-btn submit_btn" lay-submit="" lay-filter="demo1" type="submit">保存</button>
                <button type="button" class="layui-btn layui-btn-primary" onClick="javascript :history.back(-1);">
                    返回</button>
            </div>
        </div>

    </form>
    {/if} {if empty($info)}
    <form class="layui-form" action="{:url('admin/User/grade_edit',['id'=>0])}" method="post"
        enctype="multipart/form-data">
        <div class="layui-form-item ">
            <label class="layui-form-label"><span>*</span>会员等级:</label>
            <div class="layui-input-block">
                <input type="text" name="member_grade_name" lay-verify="title" autocomplete="off" placeholder="请输入"
                    class="layui-input" id="goods_name">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label"><span>*</span>等级图标</label>
            <div class="layui-input-block">
                <div class="img-box full">
                    <section class=" img-section">
                        <div class="z_photo upimg-div clear">
                            <section class="z_file fl">
                                <img src="__STATIC__/admin/common/upfile/img/a11.png" class="add-img">
                                <input type="file" name="member_grade_img" id="file" class="file" value=""
                                    accept="image/jpg,image/jpeg,image/png,image/bmp" multiple data-id="1" />
                            </section>
                        </div>
                    </section>
                </div>
                <aside class="mask works-mask">
                    <div class="mask-content">
                        <p class="del-p ">您确定要删除作品图片吗？</p>
                        <p class="check-p"><span class="del-com wsdel-ok">确定</span><span class="wsdel-no">取消</span></p>
                    </div>
                </aside>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">会员卡背景色：</label>
            <div class="layui-input-inline">
                <input type="color" name="member_background_color" id="" value="#2D9900" />
            </div>

        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">有效期:</label>
            <div class="layui-input-inline">
                <select name="member_finite_period">
                    {if !empty($term_data)}
                    {volist name="term_data" id="vo"}
                    <option value="{$vo.term_value}">{$vo.term_name}</option>
                    {/volist}
                    {/if}
                </select>
            </div>

        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">首年消费满:</label>
            <div class="layui-input-block">
                <input type="text" name="first_year_pay_full" lay-verify="title" autocomplete="off" placeholder="请输入"
                    class="layui-input" id="sort_number">万元

            </div>
        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">次年消费满:</label>
            <div class="layui-input-block">
                <input type="text" name="second_year_pay_full" lay-verify="title" autocomplete="off" placeholder="请输入"
                    class="layui-input" id="sort_number">万元
            </div>
        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">充值送会员:</label>
            <div class="layui-input-block">
                <input type="text" name="recharge_member_send" lay-verify="title" autocomplete="off" placeholder="请输入"
                    class="layui-input" id="sort_number">万元
            </div>
        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">充值送积分:</label>
            <div class="layui-input-block">
                <input type="text" name="recharge_integral_send" lay-verify="title" autocomplete="off" placeholder="请输入"
                    class="layui-input" id="sort_number">
            </div>
        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">会员消费折扣:</label>
            <div class="layui-input-block">
                <input type="text" name="member_consumption_discount" lay-verify="title" autocomplete="off"
                    placeholder="请输入" class="layui-input" id="sort_number">
            </div>
        </div>
        <div class="layui-form-item ">
            <label class="layui-form-label">是否介绍隐藏:</label>
            <div class="layui-input-block">
                <input type="radio" name="introduction_display" value="-1" title="隐藏" checked="">
                <input type="radio" name="introduction_display" value="1" title="不隐藏"> </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-input-block">
                <button class="layui-btn submit_btn" lay-submit="" lay-filter="demo1" type="submit">保存</button>
                <button type="button" class="layui-btn layui-btn-primary" onClick="javascript :history.back(-1);">
                    返回</button>
            </div>
        </div>
    </form>
    {/if} {/block}

    <!--_footer 作为公共模版分离出去-->
    {include file="template/_footer" /}
    <!--/_footer 作为公共模版分离出去-->

    <!--请在下方写此页面业务相关的脚本-->
    {block name="bottom"}
    <script type="text/javascript">
        function tab(i) {
            if (i == 1) {
                $(".tab11").addClass("active");
                $(".tab21").removeClass("active");
                $(".set_c").show();
                $(".set_x").hide();
                $('#search1').show();
                $('#search2').hide();
            }
            if (i == 2) {
                $(".tab11").removeClass("active");
                $(".tab21").addClass("active");
                $(".set_c").hide();
                $(".set_x").show();
                $('#search2').show();
                $('#search1').hide();
            }
        };
        
        $(function () {
            $("#selectUrl").find('#selectUrlTab a').click(function (e) {
                $('#tab').val($(this).attr('href'));
                e.preventDefault();
                $(this).tab('show');
            });
        });

        $(function () {
            var search_input1 = $("#search_input1"),
                set_c = $("#set_c");

            $('#search_icon1').click(function () {
                if (search_input1.val() == '') {
                    $('#set_c nav').show();
                }
                $("#set_c .text:contains(" + search_input1.val().trim() + ")").show();
                $("#set_c .text:not(:contains(" + search_input1.val().trim() + "))").parent().hide();
            })

        });
        $(function () {
            var search_input2 = $("#search_input2"),
                set_x = $("#set_x");

            $('#search_icon2').click(function () {
                if (search_input2.val() == '') {
                    $('#set_x nav').show();
                }
                $("#set_x .text:contains(" + search_input2.val().trim() + ")").show();
                $("#set_x .text:not(:contains(" + search_input2.val().trim() + "))").parent().hide();
            })

        });
        layui.config({
            base: "js/"
        }).use(['form', 'layer', 'jquery', 'laypage', 'layedit'], function () {
            var form = layui.form(),
                layedit = layui.layedit,
                layer = parent.layer === undefined ? layui.layer : parent.layer,
                laypage = layui.laypage,
                $ = layui.jquery;

              
        $('#tup').click(() => {
            $(".fade").removeClass('noshow');
            $(".fade").addClass('in show');
        });
        $('.close').click(() => {
            $(".fade").removeClass('in show');
            $(".fade").addClass('noshow');
        });
            // 图片删除
            $(".remove-img").click(function () {
                var remove = $(this).parent();
                var id = $(this).data("id");
                var value = $(this).data("value");
                console.log(value)
                console.log(id);
                if (value == 1) {
                    $.ajax({
                        type: "POST",
                        url: "{:url('admin/User/grade_start_image_del')}",
                        data: {
                            "id": id
                        },
                        dataType: "json",
                        success: function (data) {
                            remove.remove();
                        },
                        error: function (data) {
                            console.log("错误");
                        }
                    });
                } else {
                    $.ajax({
                        type: "POST",
                        url: "{:url('admin/User/grade_start_image_del')}",
                        data: {
                            "id": id
                        },
                        dataType: "json",
                        success: function (data) {
                            remove.remove();
                        },
                        error: function (data) {
                            console.log("错误");
                        }
                    });
                }
                // 		
            });
        });
    </script>
    {/block}

</body>

</html>